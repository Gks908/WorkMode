name: Windows Workflow

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    
    steps:
      - name: Download TeamViewer
        run: |
          $url = 'https://download.teamviewer.com/download/TeamViewer_Setup.exe'
          $output = 'TeamViewer_Setup.exe'
          (New-Object System.Net.WebClient).DownloadFile($url, $output)
      
      - name: Install TeamViewer
        run: |
          Start-Process -Wait -FilePath 'TeamViewer_Setup.exe' -ArgumentList '/S'
      
      - name: Set TeamViewer password
        run: |
          reg add "HKEY_LOCAL_MACHINE\SOFTWARE\TeamViewer" /v "Security_PasswordAES" /t REG_SZ /d "disalardp" /f
      
      - name: Retrieve TeamViewer ID
        run: |
          & "TeamViewer.exe" --info printid


        
      - name: Time
        run: sleep 21000
